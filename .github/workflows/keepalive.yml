name: keepalive-render

on:
  schedule:
    # 정각(00분)은 큐 밀려서 지연이 종종 있어 2분 오프셋 추천
    - cron: "2-59/5 * * * *"
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping (with timing)
        run: |
          set -e
          echo "UTC now: $(date -u +'%F %T')"
          curl -sS -L -o /dev/null \
            -w "http=%{http_code} dns=%{time_namelookup} connect=%{time_connect} tls=%{time_appconnect} ttfb=%{time_starttransfer} total=%{time_total}\n" \
            --max-time 90 --retry 3 --retry-delay 10 \
            "https://flight-hotels.onrender.com/healthz"

